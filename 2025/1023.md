## forwardRef

forwardRef は React の機能で、親コンポーネントから子コンポーネントの DOM 要素に直接アクセスできるようにする仕組み

## 基本的な仕組み

通常の React コンポーネントでは、親から子の DOM 要素に直接アクセスできません：

```tsx
// ❌ これは動作しない
const MyInput = ({ type }) => <input type={type} />;

const Parent = () => {
  const inputRef = useRef<HTMLInputElement>(null);

  return (
    <MyInput ref={inputRef} type="text" /> // エラー！refを渡せない
  );
};
```

forwardRef を使うと、この問題を解決できます：

```tsx
// ✅ forwardRefを使用
const MyInput = forwardRef<HTMLInputElement, { type: string }>(
  ({ type }, ref) => <input type={type} ref={ref} />
);

const Parent = () => {
  const inputRef = useRef<HTMLInputElement>(null);

  const focusInput = () => {
    inputRef.current?.focus(); // DOM要素に直接アクセス可能
  };

  return <MyInput ref={inputRef} type="text" />;
};
```

## 自分が使った例

```tsx
const InputImage = forwardRef<
  HTMLInputElement, // refの型（DOM要素の型）
  { onChange: (file: File) => void } // propsの型
>(
  ({ onChange }, ref): JSX.Element => (
    <input
      type="file"
      accept=".png,.jpg,.jpeg,.gif"
      className={cx("image-input")}
      ref={ref} // refをinput要素に渡す
      onChange={(e) => {
        const file = e.target.files?.[0];
        file && onChange(file);
      }}
    />
  )
);
```

なぜ使っているのか
ImageDisplayArea コンポーネントで以下のように使用されています：

```tsx
const ImageDisplayArea = ({ imageFile, onImageChange }) => {
  const inputRef = useRef<HTMLInputElement>(null);

  const handleClickChange = () => {
    inputRef.current?.click(); // ファイル選択ダイアログを開く
  };

  return (
    <div>
      <InputImage onChange={onImageChange} ref={inputRef} />
      <div onClick={handleClickChange}>
        {" "}
        {/* 画像をクリックすると */}
        <img src={imageUrl} alt="メインビジュアル" />
      </div>
    </div>
  );
};
```

## forwardRef のメリット

- カプセル化を保ちながら DOM アクセス: コンポーネントの内部実装を隠しつつ、必要な時だけ DOM にアクセスできる
